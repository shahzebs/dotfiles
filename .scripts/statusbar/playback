#!/bin/bash

if [ "$(playerctl -l)" ]; then
    if [ "$(playerctl status)" = 'Playing' ]; then
        icon=""
    elif [ "$(playerctl status)" = 'Paused' ]; then
        icon=""
    else
        exit
    fi

    printf "$icon"

    MAXLENGTH=15

    artist="$(playerctl metadata | awk '/:artist/{for(i=3;i<=NF;++i)printf $i " "}' | sed 's/ $//')"
    title="$(playerctl metadata | awk '/:title/{for(i=3;i<=NF;++i)printf $i " "}' | sed 's/ $//')"
    if [ "$(echo $artist)" ] && [ "$(echo $title)" ]; then
        if [ $(printf "$title" | wc -c) -gt $MAXLENGTH ]; then
            title="$(printf "$title" | cut -c 1-$MAXLENGTH).."
        fi
        trackinfo="$artist - $title"
        printf "  $trackinfo"
    fi

    printf " | "
fi
